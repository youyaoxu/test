<!doctype html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,initial-scale=1.0,width=device-width" />
    <meta name="format-detection" content="telephone=no,email=no,date=no,address=no">
    <title></title>
</head>
<body>
	<div>123</div>
</body>
<!-- <script type="text/javascript" src="../js/NIM_Web_SDK_v6.1.0.js"></script> -->
<!-- <script type="text/javascript" src="../js/NIM_Web_SDK.js"></script> -->
<!-- <script type="text/javascript" src="../js/NIM_Web_Chatroom_v7.0.3.js"></script> -->
<!-- <script type="text/javascript" src="../js/NIM_Web_NIM_v7.0.3.js"></script> -->
<script type="text/javascript" src="../js/NIM_Web_SDK_v5.8.0.js"></script>
<script type="text/javascript">
	// console.log(NIM);
	console.log(SDK);

	// return;
	// var room=NIM;
	var room=SDK.Chatroom;
	var chat_room=room.getInstall({
            appKey: key,
            account: 'account',
            token: token,
            chatroomId: '36',
            chatroomAddresses: [
                'address1',
                'address2'
            ],
            onconnect: onChatroomConnect,
            onerror: onChatroomError,
            onwillreconnect: onChatroomWillReconnect,
            ondisconnect: onChatroomDisconnect,
            onmsgs:onChatroomMsgs
        })
		
		console.log(NIM);
		var key="0bbdc400de8594af85465090cffdf855";
		var token="231e008143fb";
		// var room=SDK.NIM;
		

		// 进入聊天室
        var onChatroomConnect=function(obj){
            console.log("进入聊天室",obj);
            // 连接成功后才可以发消息
            var msg = chatroom.sendText({
                text: 'hello',
                done: function sendChatroomMsgDone (msgObj) {
                    console.log("发送完成后返回结果:",msgObj);
                }
            })
        };
        // 即将重连
        var onChatroomWillReconnect=function(){
            // 此时说明 `SDK` 已经断开连接, 请开发者在界面上提示用户连接已断开, 而且正在重新建立连接
            console.log('即将重连', obj);
        };
        // 连接断开
        var onChatroomDisconnect=function(){
            // 此时说明 `SDK` 处于断开状态, 开发者此时应该根据错误码提示相应的错误信息, 并且跳转到登录页面
            console.log('连接断开', error);
            if (error) {
                switch (error.code) {
                // 账号或者密码错误, 请跳转到登录页面并提示错误
                case 302:
                break;
                // 被踢, 请提示错误后跳转到登录页面
                case 'kicked':
                break;
                default:
                break;
                }
            }
        };
        // 发生错误
        var onChatroomError=function(error, obj){
            console.log('发生错误', error, obj);
        };
        // 收到聊天室消息
        var onChatroomMsgs=function(msgs){
            console.log('收到聊天室消息', msgs);
        };
        // 断开聊天室
        var disconnect=function(){
            chatroom.disconnect()
        };
        // 发送信息
        var sendText=function(){
            var msg = chatroom.sendText({
                text: 'hello',
                done: sendChatroomMsgDone
            });
            console.log('正在发送聊天室text消息, id=' + msg.idClient);
            function sendChatroomMsgDone(error, msg) {
                console.log('发送聊天室' + msg.type + '消息' + (!error?'成功':'失败') + ', id=' + msg.idClient, error, msg);
            }
        };
        // 获取聊天室历史消息
        var getHistoryMsgs=function(){
            chatroom.getHistoryMsgs({
                timetag: 1451393192478,
                limit: 100,
                msgTypes: ['text', 'image'],
                done: getHistoryMsgsDone
            })

            function getHistoryMsgsDone(error, obj) {
                console.log('获取聊天室历史' + (!error?'成功':'失败'), error, obj.msgs);
            }
        };
        //设置聊天室禁言名单
        var markChatroomGaglist=function(){
            chatroom.markChatroomGaglist({
                account: 'account',
                isAdd: true,
                done: markChatroomGaglistDone
            });
            function markChatroomGaglistDone(error, obj) {
                console.log('添加聊天室禁言名单' + (!error?'成功':'失败'), error, obj.member);
            }
        }
</script>
</html>